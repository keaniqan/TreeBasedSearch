Frozen 

Epoch 1/30

val_macro_f1: 0.5243

Epoch 1: val_macro_f1 improved from None to 0.52430, saving model to models\resnet_frozen.keras
64/64 - 73s - 1s/step - acc: 0.3916 - loss: 1.4292 - val_acc: 0.5426 - val_loss: 1.0973 - val_macro_f1: 0.5243 - learning_rate: 3.0000e-04
Epoch 2/30

val_macro_f1: 0.5578

Epoch 2: val_macro_f1 improved from 0.52430 to 0.55784, saving model to models\resnet_frozen.keras
64/64 - 60s - 939ms/step - acc: 0.5368 - loss: 1.1458 - val_acc: 0.5814 - val_loss: 1.0066 - val_macro_f1: 0.5578 - learning_rate: 3.0000e-04
Epoch 3/30

val_macro_f1: 0.6021

Epoch 3: val_macro_f1 improved from 0.55784 to 0.60208, saving model to models\resnet_frozen.keras
64/64 - 60s - 942ms/step - acc: 0.5903 - loss: 1.0387 - val_acc: 0.6124 - val_loss: 0.9568 - val_macro_f1: 0.6021 - learning_rate: 3.0000e-04
Epoch 4/30

val_macro_f1: 0.6163

Epoch 4: val_macro_f1 improved from 0.60208 to 0.61629, saving model to models\resnet_frozen.keras
64/64 - 60s - 941ms/step - acc: 0.5927 - loss: 1.0144 - val_acc: 0.6279 - val_loss: 0.9267 - val_macro_f1: 0.6163 - learning_rate: 3.0000e-04
Epoch 5/30

val_macro_f1: 0.6264

Epoch 5: val_macro_f1 improved from 0.61629 to 0.62635, saving model to models\resnet_frozen.keras
64/64 - 60s - 936ms/step - acc: 0.6300 - loss: 0.9507 - val_acc: 0.6395 - val_loss: 0.9174 - val_macro_f1: 0.6264 - learning_rate: 3.0000e-04
Epoch 6/30

val_macro_f1: 0.6089

Epoch 6: val_macro_f1 did not improve from 0.62635
64/64 - 60s - 938ms/step - acc: 0.6467 - loss: 0.9317 - val_acc: 0.6240 - val_loss: 0.9079 - val_macro_f1: 0.6089 - learning_rate: 3.0000e-04
Epoch 7/30

val_macro_f1: 0.6273

Epoch 7: val_macro_f1 improved from 0.62635 to 0.62728, saving model to models\resnet_frozen.keras
64/64 - 61s - 947ms/step - acc: 0.6359 - loss: 0.9318 - val_acc: 0.6434 - val_loss: 0.9025 - val_macro_f1: 0.6273 - learning_rate: 3.0000e-04
Epoch 8/30

val_macro_f1: 0.6058

Epoch 8: val_macro_f1 did not improve from 0.62728
64/64 - 58s - 909ms/step - acc: 0.6658 - loss: 0.8979 - val_acc: 0.6163 - val_loss: 0.8991 - val_macro_f1: 0.6058 - learning_rate: 3.0000e-04
Epoch 9/30

val_macro_f1: 0.6420

Epoch 9: val_macro_f1 improved from 0.62728 to 0.64199, saving model to models\resnet_frozen.keras
64/64 - 59s - 925ms/step - acc: 0.6816 - loss: 0.8523 - val_acc: 0.6667 - val_loss: 0.8971 - val_macro_f1: 0.6420 - learning_rate: 3.0000e-04
Epoch 10/30

val_macro_f1: 0.6273

Epoch 10: val_macro_f1 did not improve from 0.64199
64/64 - 58s - 912ms/step - acc: 0.6860 - loss: 0.8414 - val_acc: 0.6434 - val_loss: 0.8942 - val_macro_f1: 0.6273 - learning_rate: 3.0000e-04
Epoch 11/30

val_macro_f1: 0.6387

Epoch 11: val_macro_f1 did not improve from 0.64199
64/64 - 58s - 911ms/step - acc: 0.6688 - loss: 0.8487 - val_acc: 0.6512 - val_loss: 0.9004 - val_macro_f1: 0.6387 - learning_rate: 3.0000e-04
Epoch 12/30

val_macro_f1: 0.6384

Epoch 12: val_macro_f1 did not improve from 0.64199
64/64 - 59s - 919ms/step - acc: 0.6987 - loss: 0.8101 - val_acc: 0.6512 - val_loss: 0.8863 - val_macro_f1: 0.6384 - learning_rate: 3.0000e-04
Epoch 13/30

val_macro_f1: 0.6326

Epoch 13: val_macro_f1 did not improve from 0.64199
64/64 - 59s - 927ms/step - acc: 0.6894 - loss: 0.8171 - val_acc: 0.6434 - val_loss: 0.9117 - val_macro_f1: 0.6326 - learning_rate: 3.0000e-04
Epoch 14/30

val_macro_f1: 0.6609

Epoch 14: val_macro_f1 improved from 0.64199 to 0.66089, saving model to models\resnet_frozen.keras
64/64 - 60s - 934ms/step - acc: 0.7031 - loss: 0.8089 - val_acc: 0.6705 - val_loss: 0.8533 - val_macro_f1: 0.6609 - learning_rate: 3.0000e-04
Epoch 15/30

val_macro_f1: 0.6551

Epoch 15: val_macro_f1 did not improve from 0.66089
64/64 - 62s - 975ms/step - acc: 0.7041 - loss: 0.8077 - val_acc: 0.6628 - val_loss: 0.8872 - val_macro_f1: 0.6551 - learning_rate: 3.0000e-04
Epoch 16/30

val_macro_f1: 0.6148

Epoch 16: val_macro_f1 did not improve from 0.66089

Epoch 16: ReduceLROnPlateau reducing learning rate to 0.0001500000071246177.
64/64 - 62s - 968ms/step - acc: 0.7203 - loss: 0.7841 - val_acc: 0.6279 - val_loss: 0.8908 - val_macro_f1: 0.6148 - learning_rate: 3.0000e-04
Epoch 17/30

val_macro_f1: 0.6457

Epoch 17: val_macro_f1 did not improve from 0.66089
64/64 - 59s - 927ms/step - acc: 0.7213 - loss: 0.7720 - val_acc: 0.6512 - val_loss: 0.8569 - val_macro_f1: 0.6457 - learning_rate: 1.5000e-04
Epoch 18/30

val_macro_f1: 0.6537

Epoch 18: val_macro_f1 did not improve from 0.66089

Epoch 18: ReduceLROnPlateau reducing learning rate to 7.500000356230885e-05.
64/64 - 60s - 931ms/step - acc: 0.7144 - loss: 0.7866 - val_acc: 0.6589 - val_loss: 0.8616 - val_macro_f1: 0.6537 - learning_rate: 1.5000e-04
Epoch 19/30

val_macro_f1: 0.6372

Epoch 19: val_macro_f1 did not improve from 0.66089
64/64 - 59s - 915ms/step - acc: 0.7184 - loss: 0.7756 - val_acc: 0.6473 - val_loss: 0.8689 - val_macro_f1: 0.6372 - learning_rate: 7.5000e-05

Fine Tuned
Epoch 1/60

val_macro_f1: 0.6616

Epoch 1: val_macro_f1 improved from None to 0.66156, saving model to models\resnet_finetuned.keras
64/64 - 103s - 2s/step - acc: 0.7076 - loss: 0.8026 - val_acc: 0.6667 - val_loss: 0.8356 - val_macro_f1: 0.6616 - learning_rate: 1.0000e-05
Epoch 2/60

val_macro_f1: 0.6643

Epoch 2: val_macro_f1 improved from 0.66156 to 0.66432, saving model to models\resnet_finetuned.keras
64/64 - 85s - 1s/step - acc: 0.7306 - loss: 0.7432 - val_acc: 0.6744 - val_loss: 0.8703 - val_macro_f1: 0.6643 - learning_rate: 1.0000e-05
Epoch 3/60

val_macro_f1: 0.6696

Epoch 3: val_macro_f1 improved from 0.66432 to 0.66958, saving model to models\resnet_finetuned.keras
64/64 - 84s - 1s/step - acc: 0.7576 - loss: 0.7006 - val_acc: 0.6744 - val_loss: 0.8184 - val_macro_f1: 0.6696 - learning_rate: 1.0000e-05
Epoch 4/60

val_macro_f1: 0.6692

Epoch 4: val_macro_f1 did not improve from 0.66958
64/64 - 82s - 1s/step - acc: 0.7890 - loss: 0.6521 - val_acc: 0.6744 - val_loss: 0.8198 - val_macro_f1: 0.6692 - learning_rate: 1.0000e-05
Epoch 5/60

val_macro_f1: 0.6743

Epoch 5: val_macro_f1 improved from 0.66958 to 0.67434, saving model to models\resnet_finetuned.keras

Epoch 5: ReduceLROnPlateau reducing learning rate to 4.999999873689376e-06.
64/64 - 85s - 1s/step - acc: 0.7890 - loss: 0.6441 - val_acc: 0.6860 - val_loss: 0.8815 - val_macro_f1: 0.6743 - learning_rate: 1.0000e-05
Epoch 6/60

val_macro_f1: 0.7004

Epoch 6: val_macro_f1 improved from 0.67434 to 0.70041, saving model to models\resnet_finetuned.keras
64/64 - 85s - 1s/step - acc: 0.8366 - loss: 0.5691 - val_acc: 0.7054 - val_loss: 0.8547 - val_macro_f1: 0.7004 - learning_rate: 5.0000e-06
Epoch 7/60

val_macro_f1: 0.6798

Epoch 7: val_macro_f1 did not improve from 0.70041

Epoch 7: ReduceLROnPlateau reducing learning rate to 2.499999936844688e-06.
64/64 - 83s - 1s/step - acc: 0.8494 - loss: 0.5501 - val_acc: 0.6860 - val_loss: 0.8205 - val_macro_f1: 0.6798 - learning_rate: 5.0000e-06
Epoch 8/60

val_macro_f1: 0.6763

Epoch 8: val_macro_f1 did not improve from 0.70041
64/64 - 83s - 1s/step - acc: 0.8631 - loss: 0.5300 - val_acc: 0.6822 - val_loss: 0.8414 - val_macro_f1: 0.6763 - learning_rate: 2.5000e-06
Epoch 9/60

val_macro_f1: 0.6946

Epoch 9: val_macro_f1 did not improve from 0.70041

Epoch 9: ReduceLROnPlateau reducing learning rate to 1.249999968422344e-06.
64/64 - 81s - 1s/step - acc: 0.8557 - loss: 0.5327 - val_acc: 0.7016 - val_loss: 0.8418 - val_macro_f1: 0.6946 - learning_rate: 2.5000e-06
Epoch 10/60

val_macro_f1: 0.7008

Epoch 10: val_macro_f1 improved from 0.70041 to 0.70080, saving model to models\resnet_finetuned.keras
64/64 - 84s - 1s/step - acc: 0.8592 - loss: 0.5221 - val_acc: 0.7054 - val_loss: 0.8401 - val_macro_f1: 0.7008 - learning_rate: 1.2500e-06
Epoch 11/60

val_macro_f1: 0.7062

Epoch 11: val_macro_f1 improved from 0.70080 to 0.70625, saving model to models\resnet_finetuned.keras

Epoch 11: ReduceLROnPlateau reducing learning rate to 6.24999984211172e-07.
64/64 - 84s - 1s/step - acc: 0.8759 - loss: 0.5119 - val_acc: 0.7093 - val_loss: 0.8513 - val_macro_f1: 0.7062 - learning_rate: 1.2500e-06
Epoch 12/60

val_macro_f1: 0.6885

Epoch 12: val_macro_f1 did not improve from 0.70625
64/64 - 81s - 1s/step - acc: 0.8793 - loss: 0.5031 - val_acc: 0.6938 - val_loss: 0.8540 - val_macro_f1: 0.6885 - learning_rate: 6.2500e-07
Epoch 13/60

val_macro_f1: 0.6978

Epoch 13: val_macro_f1 did not improve from 0.70625

Epoch 13: ReduceLROnPlateau reducing learning rate to 3.12499992105586e-07.
64/64 - 82s - 1s/step - acc: 0.8759 - loss: 0.5060 - val_acc: 0.7016 - val_loss: 0.8477 - val_macro_f1: 0.6978 - learning_rate: 6.2500e-07
Epoch 14/60

val_macro_f1: 0.6885

Epoch 14: val_macro_f1 did not improve from 0.70625
64/64 - 82s - 1s/step - acc: 0.8754 - loss: 0.4954 - val_acc: 0.6938 - val_loss: 0.8548 - val_macro_f1: 0.6885 - learning_rate: 3.1250e-07
Epoch 15/60

val_macro_f1: 0.6928

Epoch 15: val_macro_f1 did not improve from 0.70625

Epoch 15: ReduceLROnPlateau reducing learning rate to 1.56249996052793e-07.
64/64 - 82s - 1s/step - acc: 0.8788 - loss: 0.4972 - val_acc: 0.6977 - val_loss: 0.8536 - val_macro_f1: 0.6928 - learning_rate: 3.1250e-07
Epoch 16/60

val_macro_f1: 0.6885

Epoch 16: val_macro_f1 did not improve from 0.70625
64/64 - 84s - 1s/step - acc: 0.8719 - loss: 0.5007 - val_acc: 0.6938 - val_loss: 0.8577 - val_macro_f1: 0.6885 - learning_rate: 1.5625e-07

Found 7626 files belonging to 6 classes.
Using 762 files for validation.
1/1 ━━━━━━━━━━━━━━━━━━━━ 1s 844ms/step
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
Cell In[50], line 27
     25 ax = plt.subplot(3, 4, i + 1)
     26 img = images[idx].numpy().astype("uint8")
---> 27 true_label = class_names[true_ids[idx]]
     28 pred_label = class_names[pred_ids[idx]]
     29 color = "green" if pred_label == true_label else "red"

IndexError: list index out of range




Data redistribution complete.
Class '00-none': Training=563, Validation=70, Testing=71
Class '01-minor': Training=389, Validation=48, Testing=50
Class '02-moderate': Training=528, Validation=66, Testing=67
Class '03-severe': Training=555, Validation=69, Testing=70
Found 2035 files belonging to 4 classes.
Found 253 files belonging to 4 classes.
Found 258 files belonging to 4 classes.
Classes: ['00-none', '01-minor', '02-moderate', '03-severe']
Model: "functional_17"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ input_layer_13 (InputLayer)     │ (None, 224, 224, 3)    │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ augment (Sequential)            │ (None, 224, 224, 3)    │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ true_divide_2 (TrueDivide)      │ (None, 224, 224, 3)    │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ subtract_2 (Subtract)           │ (None, 224, 224, 3)    │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ xception (Functional)           │ (None, 7, 7, 2048)     │    20,861,480 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ global_average_pooling2d_4      │ (None, 2048)           │             0 │
│ (GlobalAveragePooling2D)        │                        │               │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_4 (Dropout)             │ (None, 2048)           │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_4 (Dense)                 │ (None, 4)              │         8,196 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 20,869,676 (79.61 MB)
 Trainable params: 8,196 (32.02 KB)
 Non-trainable params: 20,861,480 (79.58 MB)
Epoch 1/30

val_macro_f1: 0.4463

Epoch 1: val_macro_f1 improved from None to 0.44630, saving model to models\xception_frozen.keras
64/64 - 80s - 1s/step - acc: 0.3897 - loss: 1.3023 - val_acc: 0.4822 - val_loss: 1.1981 - val_macro_f1: 0.4463 - learning_rate: 3.0000e-04
Epoch 2/30

val_macro_f1: 0.5037

Epoch 2: val_macro_f1 improved from 0.44630 to 0.50371, saving model to models\xception_frozen.keras
64/64 - 70s - 1s/step - acc: 0.5238 - loss: 1.1483 - val_acc: 0.5336 - val_loss: 1.1302 - val_macro_f1: 0.5037 - learning_rate: 3.0000e-04
Epoch 3/30

val_macro_f1: 0.5446

Epoch 3: val_macro_f1 improved from 0.50371 to 0.54457, saving model to models\xception_frozen.keras
64/64 - 70s - 1s/step - acc: 0.5538 - loss: 1.0813 - val_acc: 0.5692 - val_loss: 1.0567 - val_macro_f1: 0.5446 - learning_rate: 3.0000e-04
Epoch 4/30

val_macro_f1: 0.5388

Epoch 4: val_macro_f1 did not improve from 0.54457
64/64 - 69s - 1s/step - acc: 0.5956 - loss: 1.0314 - val_acc: 0.5771 - val_loss: 1.0395 - val_macro_f1: 0.5388 - learning_rate: 3.0000e-04
Epoch 5/30

val_macro_f1: 0.5586

Epoch 5: val_macro_f1 improved from 0.54457 to 0.55861, saving model to models\xception_frozen.keras
64/64 - 71s - 1s/step - acc: 0.6211 - loss: 0.9910 - val_acc: 0.5810 - val_loss: 1.0058 - val_macro_f1: 0.5586 - learning_rate: 3.0000e-04
Epoch 6/30

val_macro_f1: 0.5562

Epoch 6: val_macro_f1 did not improve from 0.55861
64/64 - 69s - 1s/step - acc: 0.6138 - loss: 0.9837 - val_acc: 0.5731 - val_loss: 0.9929 - val_macro_f1: 0.5562 - learning_rate: 3.0000e-04
Epoch 7/30

val_macro_f1: 0.5570

Epoch 7: val_macro_f1 did not improve from 0.55861
64/64 - 69s - 1s/step - acc: 0.6319 - loss: 0.9468 - val_acc: 0.5889 - val_loss: 0.9817 - val_macro_f1: 0.5570 - learning_rate: 3.0000e-04
Epoch 8/30

val_macro_f1: 0.5714

Epoch 8: val_macro_f1 improved from 0.55861 to 0.57138, saving model to models\xception_frozen.keras
64/64 - 70s - 1s/step - acc: 0.6285 - loss: 0.9497 - val_acc: 0.5771 - val_loss: 0.9683 - val_macro_f1: 0.5714 - learning_rate: 3.0000e-04
Epoch 9/30

val_macro_f1: 0.5730

Epoch 9: val_macro_f1 improved from 0.57138 to 0.57304, saving model to models\xception_frozen.keras
64/64 - 70s - 1s/step - acc: 0.6442 - loss: 0.9345 - val_acc: 0.5850 - val_loss: 0.9664 - val_macro_f1: 0.5730 - learning_rate: 3.0000e-04
Epoch 10/30

val_macro_f1: 0.5841

Epoch 10: val_macro_f1 improved from 0.57304 to 0.58413, saving model to models\xception_frozen.keras
64/64 - 70s - 1s/step - acc: 0.6590 - loss: 0.9056 - val_acc: 0.6126 - val_loss: 0.9732 - val_macro_f1: 0.5841 - learning_rate: 3.0000e-04
Epoch 11/30

val_macro_f1: 0.5711

Epoch 11: val_macro_f1 did not improve from 0.58413
64/64 - 69s - 1s/step - acc: 0.6462 - loss: 0.9138 - val_acc: 0.5929 - val_loss: 0.9453 - val_macro_f1: 0.5711 - learning_rate: 3.0000e-04
Epoch 12/30

val_macro_f1: 0.6059

Epoch 12: val_macro_f1 improved from 0.58413 to 0.60592, saving model to models\xception_frozen.keras
64/64 - 70s - 1s/step - acc: 0.6673 - loss: 0.8944 - val_acc: 0.6126 - val_loss: 0.9372 - val_macro_f1: 0.6059 - learning_rate: 3.0000e-04
Epoch 13/30

val_macro_f1: 0.5831

Epoch 13: val_macro_f1 did not improve from 0.60592
64/64 - 70s - 1s/step - acc: 0.6629 - loss: 0.8929 - val_acc: 0.5968 - val_loss: 0.9463 - val_macro_f1: 0.5831 - learning_rate: 3.0000e-04
Epoch 14/30

val_macro_f1: 0.5695

Epoch 14: val_macro_f1 did not improve from 0.60592
64/64 - 70s - 1s/step - acc: 0.6737 - loss: 0.8782 - val_acc: 0.6047 - val_loss: 0.9348 - val_macro_f1: 0.5695 - learning_rate: 3.0000e-04
Epoch 15/30

val_macro_f1: 0.5736

Epoch 15: val_macro_f1 did not improve from 0.60592
64/64 - 78s - 1s/step - acc: 0.6536 - loss: 0.8892 - val_acc: 0.5850 - val_loss: 0.9294 - val_macro_f1: 0.5736 - learning_rate: 3.0000e-04
Epoch 16/30

val_macro_f1: 0.5933

Epoch 16: val_macro_f1 did not improve from 0.60592
64/64 - 72s - 1s/step - acc: 0.6835 - loss: 0.8620 - val_acc: 0.6047 - val_loss: 0.9217 - val_macro_f1: 0.5933 - learning_rate: 3.0000e-04
Epoch 17/30

val_macro_f1: 0.6088

Epoch 17: val_macro_f1 improved from 0.60592 to 0.60876, saving model to models\xception_frozen.keras
64/64 - 73s - 1s/step - acc: 0.6703 - loss: 0.8804 - val_acc: 0.6166 - val_loss: 0.9123 - val_macro_f1: 0.6088 - learning_rate: 3.0000e-04
Epoch 18/30

val_macro_f1: 0.6033

Epoch 18: val_macro_f1 did not improve from 0.60876
64/64 - 72s - 1s/step - acc: 0.6885 - loss: 0.8544 - val_acc: 0.6087 - val_loss: 0.9182 - val_macro_f1: 0.6033 - learning_rate: 3.0000e-04
Epoch 19/30

val_macro_f1: 0.6089

Epoch 19: val_macro_f1 improved from 0.60876 to 0.60892, saving model to models\xception_frozen.keras

Epoch 19: ReduceLROnPlateau reducing learning rate to 0.0001500000071246177.
64/64 - 74s - 1s/step - acc: 0.6806 - loss: 0.8511 - val_acc: 0.6166 - val_loss: 0.9259 - val_macro_f1: 0.6089 - learning_rate: 3.0000e-04
Epoch 20/30

val_macro_f1: 0.6073

Epoch 20: val_macro_f1 did not improve from 0.60892
64/64 - 73s - 1s/step - acc: 0.6806 - loss: 0.8510 - val_acc: 0.6087 - val_loss: 0.9143 - val_macro_f1: 0.6073 - learning_rate: 1.5000e-04
Epoch 21/30

val_macro_f1: 0.5907

Epoch 21: val_macro_f1 did not improve from 0.60892

Epoch 21: ReduceLROnPlateau reducing learning rate to 7.500000356230885e-05.
64/64 - 72s - 1s/step - acc: 0.6830 - loss: 0.8437 - val_acc: 0.6087 - val_loss: 0.9145 - val_macro_f1: 0.5907 - learning_rate: 1.5000e-04
Epoch 22/30

val_macro_f1: 0.5970

Epoch 22: val_macro_f1 did not improve from 0.60892
64/64 - 73s - 1s/step - acc: 0.7027 - loss: 0.8307 - val_acc: 0.6087 - val_loss: 0.9092 - val_macro_f1: 0.5970 - learning_rate: 7.5000e-05
Epoch 23/30

val_macro_f1: 0.6096

Epoch 23: val_macro_f1 improved from 0.60892 to 0.60965, saving model to models\xception_frozen.keras
64/64 - 74s - 1s/step - acc: 0.6894 - loss: 0.8574 - val_acc: 0.6166 - val_loss: 0.9086 - val_macro_f1: 0.6096 - learning_rate: 7.5000e-05
Epoch 24/30

val_macro_f1: 0.5934

Epoch 24: val_macro_f1 did not improve from 0.60965
64/64 - 73s - 1s/step - acc: 0.6840 - loss: 0.8400 - val_acc: 0.6047 - val_loss: 0.9112 - val_macro_f1: 0.5934 - learning_rate: 7.5000e-05
Epoch 25/30

val_macro_f1: 0.6025

Epoch 25: val_macro_f1 did not improve from 0.60965

Epoch 25: ReduceLROnPlateau reducing learning rate to 3.7500001781154424e-05.
64/64 - 73s - 1s/step - acc: 0.6963 - loss: 0.8409 - val_acc: 0.6166 - val_loss: 0.9117 - val_macro_f1: 0.6025 - learning_rate: 7.5000e-05
Epoch 26/30

val_macro_f1: 0.5986

Epoch 26: val_macro_f1 did not improve from 0.60965
64/64 - 76s - 1s/step - acc: 0.6914 - loss: 0.8317 - val_acc: 0.6126 - val_loss: 0.9082 - val_macro_f1: 0.5986 - learning_rate: 3.7500e-05
Epoch 27/30

val_macro_f1: 0.5986

Epoch 27: val_macro_f1 did not improve from 0.60965
64/64 - 73s - 1s/step - acc: 0.6806 - loss: 0.8415 - val_acc: 0.6126 - val_loss: 0.9073 - val_macro_f1: 0.5986 - learning_rate: 3.7500e-05
Epoch 28/30

val_macro_f1: 0.6033

Epoch 28: val_macro_f1 did not improve from 0.60965
64/64 - 72s - 1s/step - acc: 0.7022 - loss: 0.8325 - val_acc: 0.6166 - val_loss: 0.9077 - val_macro_f1: 0.6033 - learning_rate: 3.7500e-05
Epoch 1/60

val_macro_f1: 0.6206

Epoch 1: val_macro_f1 improved from None to 0.62058, saving model to models\xception_finetuned.keras
64/64 - 123s - 2s/step - acc: 0.6909 - loss: 0.8307 - val_acc: 0.6285 - val_loss: 0.8603 - val_macro_f1: 0.6206 - learning_rate: 1.0000e-05
Epoch 2/60

val_macro_f1: 0.6505

Epoch 2: val_macro_f1 improved from 0.62058 to 0.65046, saving model to models\xception_finetuned.keras
64/64 - 111s - 2s/step - acc: 0.7214 - loss: 0.7886 - val_acc: 0.6640 - val_loss: 0.8418 - val_macro_f1: 0.6505 - learning_rate: 1.0000e-05
Epoch 3/60

val_macro_f1: 0.6458

Epoch 3: val_macro_f1 did not improve from 0.65046
64/64 - 110s - 2s/step - acc: 0.7312 - loss: 0.7572 - val_acc: 0.6561 - val_loss: 0.8364 - val_macro_f1: 0.6458 - learning_rate: 1.0000e-05
Epoch 4/60

val_macro_f1: 0.6545

Epoch 4: val_macro_f1 improved from 0.65046 to 0.65452, saving model to models\xception_finetuned.keras
64/64 - 111s - 2s/step - acc: 0.7504 - loss: 0.7195 - val_acc: 0.6680 - val_loss: 0.8272 - val_macro_f1: 0.6545 - learning_rate: 1.0000e-05
Epoch 5/60

val_macro_f1: 0.6675

Epoch 5: val_macro_f1 improved from 0.65452 to 0.66748, saving model to models\xception_finetuned.keras
64/64 - 113s - 2s/step - acc: 0.7577 - loss: 0.6953 - val_acc: 0.6719 - val_loss: 0.8276 - val_macro_f1: 0.6675 - learning_rate: 1.0000e-05
Epoch 6/60

val_macro_f1: 0.6691

Epoch 6: val_macro_f1 improved from 0.66748 to 0.66915, saving model to models\xception_finetuned.keras
64/64 - 112s - 2s/step - acc: 0.7779 - loss: 0.6791 - val_acc: 0.6680 - val_loss: 0.8204 - val_macro_f1: 0.6691 - learning_rate: 1.0000e-05
Epoch 7/60

val_macro_f1: 0.6675

Epoch 7: val_macro_f1 did not improve from 0.66915
64/64 - 112s - 2s/step - acc: 0.7877 - loss: 0.6628 - val_acc: 0.6680 - val_loss: 0.8196 - val_macro_f1: 0.6675 - learning_rate: 1.0000e-05
Epoch 8/60

val_macro_f1: 0.6692

Epoch 8: val_macro_f1 improved from 0.66915 to 0.66924, saving model to models\xception_finetuned.keras
64/64 - 113s - 2s/step - acc: 0.7990 - loss: 0.6339 - val_acc: 0.6759 - val_loss: 0.8077 - val_macro_f1: 0.6692 - learning_rate: 1.0000e-05
Epoch 9/60

val_macro_f1: 0.6823

Epoch 9: val_macro_f1 improved from 0.66924 to 0.68233, saving model to models\xception_finetuned.keras
64/64 - 116s - 2s/step - acc: 0.8015 - loss: 0.6233 - val_acc: 0.6917 - val_loss: 0.8005 - val_macro_f1: 0.6823 - learning_rate: 1.0000e-05
Epoch 10/60

val_macro_f1: 0.6742

Epoch 10: val_macro_f1 did not improve from 0.68233
64/64 - 147s - 2s/step - acc: 0.8059 - loss: 0.6104 - val_acc: 0.6759 - val_loss: 0.8020 - val_macro_f1: 0.6742 - learning_rate: 1.0000e-05
Epoch 11/60

val_macro_f1: 0.6810

Epoch 11: val_macro_f1 did not improve from 0.68233

Epoch 11: ReduceLROnPlateau reducing learning rate to 4.999999873689376e-06.
64/64 - 150s - 2s/step - acc: 0.8143 - loss: 0.5974 - val_acc: 0.6877 - val_loss: 0.8035 - val_macro_f1: 0.6810 - learning_rate: 1.0000e-05
Epoch 12/60

val_macro_f1: 0.6838

Epoch 12: val_macro_f1 improved from 0.68233 to 0.68376, saving model to models\xception_finetuned.keras
64/64 - 153s - 2s/step - acc: 0.8486 - loss: 0.5630 - val_acc: 0.6877 - val_loss: 0.8134 - val_macro_f1: 0.6838 - learning_rate: 5.0000e-06
Epoch 13/60

val_macro_f1: 0.6836

Epoch 13: val_macro_f1 did not improve from 0.68376

Epoch 13: ReduceLROnPlateau reducing learning rate to 2.499999936844688e-06.
64/64 - 150s - 2s/step - acc: 0.8447 - loss: 0.5519 - val_acc: 0.6877 - val_loss: 0.8161 - val_macro_f1: 0.6836 - learning_rate: 5.0000e-06
Epoch 14/60

val_macro_f1: 0.6989

Epoch 14: val_macro_f1 improved from 0.68376 to 0.69894, saving model to models\xception_finetuned.keras
64/64 - 155s - 2s/step - acc: 0.8477 - loss: 0.5547 - val_acc: 0.7036 - val_loss: 0.8054 - val_macro_f1: 0.6989 - learning_rate: 2.5000e-06
Epoch 15/60

val_macro_f1: 0.6925

Epoch 15: val_macro_f1 did not improve from 0.69894

Epoch 15: ReduceLROnPlateau reducing learning rate to 1.249999968422344e-06.
64/64 - 116s - 2s/step - acc: 0.8413 - loss: 0.5640 - val_acc: 0.6957 - val_loss: 0.8074 - val_macro_f1: 0.6925 - learning_rate: 2.5000e-06
Epoch 16/60

val_macro_f1: 0.7016

Epoch 16: val_macro_f1 improved from 0.69894 to 0.70159, saving model to models\xception_finetuned.keras
64/64 - 116s - 2s/step - acc: 0.8560 - loss: 0.5482 - val_acc: 0.7036 - val_loss: 0.8012 - val_macro_f1: 0.7016 - learning_rate: 1.2500e-06
Epoch 17/60

val_macro_f1: 0.7045

Epoch 17: val_macro_f1 improved from 0.70159 to 0.70446, saving model to models\xception_finetuned.keras

Epoch 17: ReduceLROnPlateau reducing learning rate to 6.24999984211172e-07.
64/64 - 113s - 2s/step - acc: 0.8624 - loss: 0.5277 - val_acc: 0.7075 - val_loss: 0.8039 - val_macro_f1: 0.7045 - learning_rate: 1.2500e-06
Epoch 18/60

val_macro_f1: 0.7045

Epoch 18: val_macro_f1 did not improve from 0.70446
64/64 - 104s - 2s/step - acc: 0.8604 - loss: 0.5294 - val_acc: 0.7075 - val_loss: 0.8044 - val_macro_f1: 0.7045 - learning_rate: 6.2500e-07
Epoch 19/60

val_macro_f1: 0.7041

Epoch 19: val_macro_f1 did not improve from 0.70446

Epoch 19: ReduceLROnPlateau reducing learning rate to 3.12499992105586e-07.
64/64 - 104s - 2s/step - acc: 0.8600 - loss: 0.5327 - val_acc: 0.7075 - val_loss: 0.8036 - val_macro_f1: 0.7041 - learning_rate: 6.2500e-07
Epoch 20/60

val_macro_f1: 0.7041

Epoch 20: val_macro_f1 did not improve from 0.70446
64/64 - 105s - 2s/step - acc: 0.8555 - loss: 0.5277 - val_acc: 0.7075 - val_loss: 0.8044 - val_macro_f1: 0.7041 - learning_rate: 3.1250e-07
Epoch 21/60

val_macro_f1: 0.7045

Epoch 21: val_macro_f1 did not improve from 0.70446

Epoch 21: ReduceLROnPlateau reducing learning rate to 1.56249996052793e-07.
64/64 - 105s - 2s/step - acc: 0.8550 - loss: 0.5428 - val_acc: 0.7075 - val_loss: 0.8049 - val_macro_f1: 0.7045 - learning_rate: 3.1250e-07
Epoch 22/60

val_macro_f1: 0.7045

Epoch 22: val_macro_f1 did not improve from 0.70446
64/64 - 104s - 2s/step - acc: 0.8496 - loss: 0.5445 - val_acc: 0.7075 - val_loss: 0.8050 - val_macro_f1: 0.7045 - learning_rate: 1.5625e-07
Confusion matrix:
 [[68  3  0  0]
 [ 1 48  1  0]
 [ 2  4 53  8]
 [ 1  1  6 62]]

Classification report:
              precision    recall  f1-score   support

     00-none       0.94      0.96      0.95        71
    01-minor       0.86      0.96      0.91        50
 02-moderate       0.88      0.79      0.83        67
   03-severe       0.89      0.89      0.89        70

    accuracy                           0.90       258
   macro avg       0.89      0.90      0.89       258
weighted avg       0.90      0.90      0.89       258

Macro-F1: 0.8942673208532664